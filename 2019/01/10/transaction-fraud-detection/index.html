<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="Chace&#39;s Blog">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="https://shichushi.com/img/home-bg-jeep.jpg">
    <meta property="twitter:image" content="https://shichushi.com/img/home-bg-jeep.jpg" />
    

    
    <meta name="title" content="Transaction Fraud Detection in E-commerce" />
    <meta property="og:title" content="Transaction Fraud Detection in E-commerce" />
    <meta property="twitter:title" content="Transaction Fraud Detection in E-commerce" />
    

    
    <meta name="description" content="Predicts the probability that the first transaction of a new user is fraudulent">
    <meta property="og:description" content="Predicts the probability that the first transaction of a new user is fraudulent" />
    <meta property="twitter:description" content="Predicts the probability that the first transaction of a new user is fraudulent" />
    

    
    <meta property="twitter:card" content="summary" />
    
    

    <meta name="keyword"  content="史楚石, Chushi Shi, ShiChuShi, Chace Shi, 史楚石的网络日志, 史楚石的博客, shichushi Blog, chushi shi blog, 博客, 个人网站">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>Transaction Fraud Detection in E-commerce-Chushi | Chushi Shi</title>

    <link rel="canonical" href="/2019/01/10/transaction-fraud-detection/">

    <link rel="stylesheet" href="/css/iDisqus.min.css"/>
	
    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    
    <link rel="stylesheet" href="/css/syntax.css">
    
    
    <link rel="stylesheet" href="/css/zanshang.css">
    
    
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    
    

    
    
    <script src="/js/jquery.min.js"></script>
    
    
    <script src="/js/bootstrap.min.js"></script>
    
    
    <script src="/js/hux-blog.min.js"></script>

    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/docco.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    

</head>



<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Chace&#39;s Blog</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                        
                        <li>
                            <a href="/categories/project">Project</a>
                        </li>
                        
                        <li>
                            <a href="/categories/tech">Tech</a>
                        </li>
                        
                    
                    
		    
                        <li><a href="/top/books/">BOOKS</a></li>
                    
                        <li><a href="/top/about/">ABOUT</a></li>
                    

                    
		    <li>
                        <a href="/search">SEARCH <img src="/img/search.png" height="15" style="cursor: pointer;" alt="Search"></a>
		    </li>
                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('https://img.zhaohuabing.com/in-post/istio-traffic-shifting/crossroads.png')
    }
</style>
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/fraud-detection" title="Fraud Detection">
                            Fraud Detection
                        </a>
                        
                        <a class="tag" href="/tags/machine-learning" title="Machine learning">
                            Machine learning
                        </a>
                        
                        <a class="tag" href="/tags/data-analysis" title="Data Analysis">
                            Data Analysis
                        </a>
                        
                        <a class="tag" href="/tags/e-commerce" title="E-commerce">
                            E-commerce
                        </a>
                        
                    </div>
                    <h1>Transaction Fraud Detection in E-commerce</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
                        Posted by 
                        
                                Chushi Shi
                         
                        on 
                        Thursday, January 10, 2019
                        
                        
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                
                <header>
                    <h2>TOC</h2>
                </header>
                <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#introduction">Introduction</a>
<ul>
<li><a href="#important-features-of-the-project">Important features of the project</a></li>
</ul></li>
<li><a href="#data-exploration">Data Exploration</a>
<ul>
<li><a href="#distribution-of-the-label-column">Distribution of the label column</a></li>
<li><a href="#missing-values">Missing values</a></li>
<li><a href="#identify-country-info-based-on-ip-address">Identify country info based on ip_address</a>
<ul>
<li><a href="#check-if-column-user-id-is-unique-no-dup-for-time-related-aggregates">check if column user_id is unique(no dup) for time related aggregates</a></li>
</ul></li>
<li><a href="#after-procressing">After procressing</a>
<ul>
<li><a href="#convert-categorical-features-with-high-cadinality-to-numericals">Convert categorical features with high cadinality to numericals</a></li>
</ul></li>
</ul></li>
<li><a href="#model-training-and-selection">Model Training and Selection</a></li>
<li><a href="#parameter-tuning-by-gridsearchcv">Parameter tuning by GridSearchCV</a></li>
<li><a href="#feature-important-by-rf">Feature Important by RF</a></li>
<li><a href="#other-attempts">Other Attempts</a>
<ul>
<li><a href="#optimizing-recall-score-on-rf-by-grid-search">Optimizing recall_score on RF by Grid Search</a></li>
</ul></li>
<li><a href="#prediction">Prediction</a>
<ul>
<li><a href="#final-result">Final Result</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
                
                <p></p>

<h2 id="introduction">Introduction</h2>

<p>E-commerce websites often transact huge amounts of money. And whenever a huge amount of money is moved, there is a high risk of users performing fraudulent activities, e.g. using stolen credit cards, doing money laundry, etc.</p>

<p>Machine Learning really excels at identifying fraudulent activities. Any website where you put your credit card information has a risk team in charge of avoiding frauds via machine learning.</p>

<p>The goal of this project is to build a machine learning model that predicts the probability that the first transaction of a new user is fraudulent. More specifically, this company is an e-commerce site that sells electronic products. I will build a model that predicts whether a user has a high probability of using the site to perform some illegal activity or not.</p>

<h3 id="important-features-of-the-project">Important features of the project</h3>

<ul>
<li>Data is highly imbalanced</li>
<li>Features of interval_after_signup and time related raw and aggregates are highly predictive of fraud</li>
<li>Made actionable operation recommendations/proposal for business</li>
</ul>

<h2 id="data-exploration">Data Exploration</h2>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>signup_time</th>
      <th>purchase_time</th>
      <th>purchase_value</th>
      <th>device_id</th>
      <th>source</th>
      <th>browser</th>
      <th>sex</th>
      <th>age</th>
      <th>ip_address</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22058</td>
      <td>2015-02-24 22:55:49</td>
      <td>2015-04-18 02:47:11</td>
      <td>34</td>
      <td>QVPSPJUOCKZAR</td>
      <td>SEO</td>
      <td>Chrome</td>
      <td>M</td>
      <td>39</td>
      <td>7.327584e+08</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>333320</td>
      <td>2015-06-07 20:39:50</td>
      <td>2015-06-08 01:38:54</td>
      <td>16</td>
      <td>EOGFQPIZPYXFZ</td>
      <td>Ads</td>
      <td>Chrome</td>
      <td>F</td>
      <td>53</td>
      <td>3.503114e+08</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>150084</td>
      <td>2015-04-28 21:13:25</td>
      <td>2015-05-04 13:54:50</td>
      <td>44</td>
      <td>ATGTXKYKUDUQN</td>
      <td>SEO</td>
      <td>Safari</td>
      <td>M</td>
      <td>41</td>
      <td>3.840542e+09</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>221365</td>
      <td>2015-07-21 07:09:52</td>
      <td>2015-09-09 18:40:53</td>
      <td>39</td>
      <td>NAUITBZFJKHWW</td>
      <td>Ads</td>
      <td>Safari</td>
      <td>M</td>
      <td>45</td>
      <td>4.155831e+08</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>159135</td>
      <td>2015-05-21 06:03:03</td>
      <td>2015-07-09 08:05:14</td>
      <td>42</td>
      <td>ALEYXFXINSXLZ</td>
      <td>Ads</td>
      <td>Chrome</td>
      <td>M</td>
      <td>18</td>
      <td>2.809315e+09</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="distribution-of-the-label-column">Distribution of the label column</h3>

<pre><code>0: 136961  
1: 1415  
</code></pre>

<h3 id="missing-values">Missing values</h3>

<pre><code>user_id           0
signup_time       0
purchase_time     0
purchase_value    0
device_id         0
source            0
browser           0
sex               0
age               0
ip_address        0
class             0
</code></pre>

<h3 id="identify-country-info-based-on-ip-address">Identify country info based on ip_address</h3>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lower_bound_ip_address</th>
      <th>upper_bound_ip_address</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16777216.0</td>
      <td>16777471</td>
      <td>Australia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>16777472.0</td>
      <td>16777727</td>
      <td>China</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16777728.0</td>
      <td>16778239</td>
      <td>China</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16778240.0</td>
      <td>16779263</td>
      <td>Australia</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16779264.0</td>
      <td>16781311</td>
      <td>China</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="check-if-column-user-id-is-unique-no-dup-for-time-related-aggregates">check if column user_id is unique(no dup) for time related aggregates</h4>

<pre><code class="language-python">print(fraud_data.user_id.nunique())#138376
print(len(fraud_data.index))#138376
#all of the user_id has only the first 1 transaction, no way to do time based aggregates, 
#e.g. amount/counts in past 1 day for this user
</code></pre>

<pre><code>138376  
138376  
</code></pre>

<h3 id="after-procressing">After procressing</h3>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>purchase_value</th>
      <th>device_id</th>
      <th>source</th>
      <th>browser</th>
      <th>sex</th>
      <th>age</th>
      <th>ip_address</th>
      <th>class</th>
      <th>country</th>
      <th>interval_after_signup</th>
      <th>signup_days_of_year</th>
      <th>signup_seconds_of_day</th>
      <th>purchase_days_of_year</th>
      <th>purchase_seconds_of_day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>34</td>
      <td>QVPSPJUOCKZAR</td>
      <td>SEO</td>
      <td>Chrome</td>
      <td>M</td>
      <td>39</td>
      <td>7.327584e+08</td>
      <td>0</td>
      <td>Japan</td>
      <td>4506682.0</td>
      <td>55</td>
      <td>82549</td>
      <td>108</td>
      <td>10031</td>
    </tr>
    <tr>
      <th>1</th>
      <td>16</td>
      <td>EOGFQPIZPYXFZ</td>
      <td>Ads</td>
      <td>Chrome</td>
      <td>F</td>
      <td>53</td>
      <td>3.503114e+08</td>
      <td>0</td>
      <td>United States</td>
      <td>17944.0</td>
      <td>158</td>
      <td>74390</td>
      <td>159</td>
      <td>5934</td>
    </tr>
    <tr>
      <th>2</th>
      <td>44</td>
      <td>ATGTXKYKUDUQN</td>
      <td>SEO</td>
      <td>Safari</td>
      <td>M</td>
      <td>41</td>
      <td>3.840542e+09</td>
      <td>0</td>
      <td>NA</td>
      <td>492085.0</td>
      <td>118</td>
      <td>76405</td>
      <td>124</td>
      <td>50090</td>
    </tr>
    <tr>
      <th>3</th>
      <td>39</td>
      <td>NAUITBZFJKHWW</td>
      <td>Ads</td>
      <td>Safari</td>
      <td>M</td>
      <td>45</td>
      <td>4.155831e+08</td>
      <td>0</td>
      <td>United States</td>
      <td>4361461.0</td>
      <td>202</td>
      <td>25792</td>
      <td>252</td>
      <td>67253</td>
    </tr>
    <tr>
      <th>4</th>
      <td>42</td>
      <td>ALEYXFXINSXLZ</td>
      <td>Ads</td>
      <td>Chrome</td>
      <td>M</td>
      <td>18</td>
      <td>2.809315e+09</td>
      <td>0</td>
      <td>Canada</td>
      <td>4240931.0</td>
      <td>141</td>
      <td>21783</td>
      <td>190</td>
      <td>29114</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">print(fraud_data.source.value_counts())
</code></pre>

<pre><code>SEO: 55766  
Ads: 54913  
Direct: 27697  
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>purchase_value</th>
      <th>device_id</th>
      <th>source</th>
      <th>browser</th>
      <th>sex</th>
      <th>age</th>
      <th>ip_address</th>
      <th>country</th>
      <th>interval_after_signup</th>
      <th>signup_days_of_year</th>
      <th>signup_seconds_of_day</th>
      <th>purchase_days_of_year</th>
      <th>purchase_seconds_of_day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>29343</th>
      <td>12</td>
      <td>OULPAZAFRFPXP</td>
      <td>Ads</td>
      <td>Chrome</td>
      <td>M</td>
      <td>42</td>
      <td>3.690922e+09</td>
      <td>Korea Republic of</td>
      <td>3499664.0</td>
      <td>183</td>
      <td>67384</td>
      <td>224</td>
      <td>24648</td>
    </tr>
    <tr>
      <th>12190</th>
      <td>10</td>
      <td>AIIWMFEYQQIEB</td>
      <td>Ads</td>
      <td>Opera</td>
      <td>M</td>
      <td>29</td>
      <td>1.686759e+09</td>
      <td>United States</td>
      <td>6766039.0</td>
      <td>5</td>
      <td>78146</td>
      <td>84</td>
      <td>18585</td>
    </tr>
    <tr>
      <th>19388</th>
      <td>34</td>
      <td>VUVETBUPCIWJE</td>
      <td>Direct</td>
      <td>Chrome</td>
      <td>M</td>
      <td>53</td>
      <td>4.138429e+09</td>
      <td>NA</td>
      <td>5870515.0</td>
      <td>197</td>
      <td>81354</td>
      <td>265</td>
      <td>76669</td>
    </tr>
    <tr>
      <th>89104</th>
      <td>48</td>
      <td>QCFULAJOYKFUU</td>
      <td>Ads</td>
      <td>Chrome</td>
      <td>M</td>
      <td>29</td>
      <td>9.617337e+07</td>
      <td>France</td>
      <td>2145618.0</td>
      <td>160</td>
      <td>30920</td>
      <td>185</td>
      <td>16538</td>
    </tr>
    <tr>
      <th>82082</th>
      <td>44</td>
      <td>IHRWLMIJMEEEU</td>
      <td>Ads</td>
      <td>FireFox</td>
      <td>M</td>
      <td>24</td>
      <td>1.936025e+09</td>
      <td>China</td>
      <td>7079059.0</td>
      <td>111</td>
      <td>71897</td>
      <td>193</td>
      <td>66156</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="convert-categorical-features-with-high-cadinality-to-numericals">Convert categorical features with high cadinality to numericals</h4>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>purchase_value</th>
      <th>sex</th>
      <th>age</th>
      <th>interval_after_signup</th>
      <th>signup_days_of_year</th>
      <th>signup_seconds_of_day</th>
      <th>purchase_days_of_year</th>
      <th>purchase_seconds_of_day</th>
      <th>source_Ads</th>
      <th>source_Direct</th>
      <th>source_SEO</th>
      <th>browser_Chrome</th>
      <th>browser_FireFox</th>
      <th>browser_IE</th>
      <th>browser_Opera</th>
      <th>browser_Safari</th>
      <th>n_dev_shared</th>
      <th>n_ip_shared</th>
      <th>n_country_shared</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>29343</th>
      <td>12</td>
      <td>1</td>
      <td>42</td>
      <td>3499664.0</td>
      <td>183</td>
      <td>67384</td>
      <td>224</td>
      <td>24648</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>3075</td>
    </tr>
    <tr>
      <th>12190</th>
      <td>10</td>
      <td>1</td>
      <td>29</td>
      <td>6766039.0</td>
      <td>5</td>
      <td>78146</td>
      <td>84</td>
      <td>18585</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>42348</td>
    </tr>
    <tr>
      <th>19388</th>
      <td>34</td>
      <td>1</td>
      <td>53</td>
      <td>5870515.0</td>
      <td>197</td>
      <td>81354</td>
      <td>265</td>
      <td>76669</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>16275</td>
    </tr>
    <tr>
      <th>89104</th>
      <td>48</td>
      <td>1</td>
      <td>29</td>
      <td>2145618.0</td>
      <td>160</td>
      <td>30920</td>
      <td>185</td>
      <td>16538</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2322</td>
    </tr>
    <tr>
      <th>82082</th>
      <td>44</td>
      <td>1</td>
      <td>24</td>
      <td>7079059.0</td>
      <td>111</td>
      <td>71897</td>
      <td>193</td>
      <td>66156</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>8876</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="model-training-and-selection">Model Training and Selection</h2>

<pre><code class="language-python">X_train.n_dev_shared.value_counts(dropna=False)
</code></pre>

<pre><code>0.0    105427
0.2      4774
0.4       324
0.6       124
0.8        45
1.0         6
</code></pre>

<pre><code class="language-python">X_test.n_dev_shared.value_counts(dropna=False)
</code></pre>

<pre><code>0.0    27330
0.2      334
0.4       12
Name: n_dev_shared, dtype: int64
</code></pre>

<ol>
<li><p>Simple LogisticRegression model<br />
        pred_0  pred_1<br />
true_0   27389       0<br />
true_1     287       0</p></li>

<li><p>Simple RF model</p>

<p>accuracy_score is: : 0.9948692007515537<br />
roc_auc_score is: : 0.7548596215347777<br />
f1_score is: : 0.6712962962962962<br />
confusion_matrix is:<br />
        pred_0  pred_1<br />
true_0   27389       0<br />
true_1     142     145<br />
recall = 0.5052264808362369<br />
precision = 1.0</p></li>
</ol>

<h2 id="parameter-tuning-by-gridsearchcv">Parameter tuning by GridSearchCV</h2>

<ul>
<li><p>Optimizing on f1_score on LR</p>

<p>Best params for f1_score<br />
{&lsquo;C&rsquo;: 0.1, &lsquo;penalty&rsquo;: &lsquo;l1&rsquo;}</p>

<p>Confusion matrix of Random Forest optimized for f1_score on the test data:<br />
pred_0 pred_1<br />
true_0 27386 3<br />
true_1   278    9<br />
    roc_auc_score is: : 0.7597098608854265<br />
    f1_score is: : 0.06020066889632108<br />
recall =  0.0313588850174216<br />
precision =  0.75</p></li>

<li><p>Optimizing on f1_score on RF</p>

<p>Best params for f1_score<br />
{&lsquo;class_weight&rsquo;: {0: 1, 1: 0.2}, &lsquo;max_depth&rsquo;: None, &lsquo;n_estimators&rsquo;: 150}</p>

<p>Confusion matrix of Random Forest optimized for f1_score on the test data:<br />
        pred_0  pred_1<br />
true_0   27389       0<br />
true_1     142     145<br />
    roc_auc_score is: : 0.7627425008361275<br />
    f1_score is: : 0.6712962962962962<br />
recall =  0.5052264808362369<br />
precision =  1.0</p></li>

<li><p>Best model
<div>
<style scoped>
.dataframe tbody tr th:only-of-type {
    vertical-align: middle;
}</p>

<p>.dataframe tbody tr th {
    vertical-align: top;
}</p>

<p>.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th></th>
  <th>mean_test_precision_score</th>
  <th>mean_test_recall_score</th>
  <th>mean_test_f1_score</th>
  <th>mean_train_precision_score</th>
  <th>mean_train_recall_score</th>
  <th>mean_train_f1_score</th>
  <th>param_max_depth</th>
  <th>param_class_weight</th>
  <th>param_n_estimators</th>
</tr>
</thead>
<tbody>
<tr>
  <th>9</th>
  <td>1.0</td>
  <td>0.527</td>
  <td>0.69</td>
  <td>1.0</td>
  <td>0.527</td>
  <td>0.690</td>
  <td>5</td>
  <td>{0: 1, 1: 1}</td>
  <td>150</td>
</tr>
<tr>
  <th>7</th>
  <td>1.0</td>
  <td>0.527</td>
  <td>0.69</td>
  <td>1.0</td>
  <td>1.000</td>
  <td>1.000</td>
  <td>None</td>
  <td>{0: 1, 1: 1}</td>
  <td>150</td>
</tr>
<tr>
  <th>13</th>
  <td>1.0</td>
  <td>0.527</td>
  <td>0.69</td>
  <td>1.0</td>
  <td>1.000</td>
  <td>1.000</td>
  <td>None</td>
  <td>{0: 1, 1: 100}</td>
  <td>150</td>
</tr>
<tr>
  <th>3</th>
  <td>1.0</td>
  <td>0.527</td>
  <td>0.69</td>
  <td>1.0</td>
  <td>0.527</td>
  <td>0.690</td>
  <td>5</td>
  <td>{0: 1, 1: 0.2}</td>
  <td>150</td>
</tr>
<tr>
  <th>11</th>
  <td>1.0</td>
  <td>0.527</td>
  <td>0.69</td>
  <td>1.0</td>
  <td>0.584</td>
  <td>0.737</td>
  <td>15</td>
  <td>{0: 1, 1: 1}</td>
  <td>150</td>
</tr>
</tbody>
</table>
</div></p></li>
</ul>

<h2 id="feature-important-by-rf">Feature Important by RF</h2>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>importance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>interval_after_signup</th>
      <td>0.394919</td>
    </tr>
    <tr>
      <th>purchase_days_of_year</th>
      <td>0.141148</td>
    </tr>
    <tr>
      <th>purchase_seconds_of_day</th>
      <td>0.081432</td>
    </tr>
    <tr>
      <th>signup_seconds_of_day</th>
      <td>0.078620</td>
    </tr>
    <tr>
      <th>signup_days_of_year</th>
      <td>0.059417</td>
    </tr>
    <tr>
      <th>n_ip_shared</th>
      <td>0.050463</td>
    </tr>
    <tr>
      <th>purchase_value</th>
      <td>0.044328</td>
    </tr>
    <tr>
      <th>n_dev_shared</th>
      <td>0.038656</td>
    </tr>
    <tr>
      <th>age</th>
      <td>0.038656</td>
    </tr>
    <tr>
      <th>n_country_shared</th>
      <td>0.027619</td>
    </tr>
    <tr>
      <th>sex</th>
      <td>0.007886</td>
    </tr>
    <tr>
      <th>source_Ads</th>
      <td>0.005919</td>
    </tr>
    <tr>
      <th>source_SEO</th>
      <td>0.005735</td>
    </tr>
    <tr>
      <th>browser_Chrome</th>
      <td>0.005264</td>
    </tr>
    <tr>
      <th>source_Direct</th>
      <td>0.005217</td>
    </tr>
    <tr>
      <th>browser_FireFox</th>
      <td>0.004753</td>
    </tr>
    <tr>
      <th>browser_IE</th>
      <td>0.004413</td>
    </tr>
    <tr>
      <th>browser_Safari</th>
      <td>0.004308</td>
    </tr>
    <tr>
      <th>browser_Opera</th>
      <td>0.001246</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="other-attempts">Other Attempts</h2>

<h3 id="optimizing-recall-score-on-rf-by-grid-search">Optimizing recall_score on RF by Grid Search</h3>

<pre><code>Best params for recall_score
{'class_weight': {0: 1, 1: 100}, 'max_depth': 5, 'n_estimators': 150}

Confusion matrix of Random Forest optimized for recall_score on the test data:
        pred_0  pred_1
true_0   27146     243
true_1     132     155
    roc_auc_score is: : 0.7904661234456265
    f1_score is: : 0.4525547445255475
recall =  0.5400696864111498
precision =  0.38944723618090454
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_test_precision_score</th>
      <th>mean_test_recall_score</th>
      <th>mean_test_f1_score</th>
      <th>mean_train_precision_score</th>
      <th>mean_train_recall_score</th>
      <th>mean_train_f1_score</th>
      <th>param_max_depth</th>
      <th>param_class_weight</th>
      <th>param_n_estimators</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>15</th>
      <td>0.159</td>
      <td>0.636</td>
      <td>0.254</td>
      <td>0.164</td>
      <td>0.656</td>
      <td>0.262</td>
      <td>5</td>
      <td>{0: 1, 1: 100}</td>
      <td>150</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.160</td>
      <td>0.633</td>
      <td>0.255</td>
      <td>0.162</td>
      <td>0.652</td>
      <td>0.260</td>
      <td>5</td>
      <td>{0: 1, 1: 100}</td>
      <td>10</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.675</td>
      <td>0.533</td>
      <td>0.593</td>
      <td>0.759</td>
      <td>0.813</td>
      <td>0.782</td>
      <td>15</td>
      <td>{0: 1, 1: 100}</td>
      <td>10</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.998</td>
      <td>0.527</td>
      <td>0.689</td>
      <td>1.000</td>
      <td>0.858</td>
      <td>0.923</td>
      <td>None</td>
      <td>{0: 1, 1: 0.2}</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.000</td>
      <td>0.527</td>
      <td>0.690</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>None</td>
      <td>{0: 1, 1: 0.2}</td>
      <td>150</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="prediction">Prediction</h2>

<pre><code class="language-python">trainDF = pd.concat([X_train, y_train], axis=1)
pd.crosstab(trainDF[&quot;n_dev_shared&quot;],trainDF[&quot;class&quot;])
#the larger n_dev_shared, the higher rate of fraud
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>class</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>n_dev_shared</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.0</th>
      <td>104966</td>
      <td>461</td>
    </tr>
    <tr>
      <th>0.2</th>
      <td>4403</td>
      <td>371</td>
    </tr>
    <tr>
      <th>0.4</th>
      <td>152</td>
      <td>172</td>
    </tr>
    <tr>
      <th>0.6</th>
      <td>37</td>
      <td>87</td>
    </tr>
    <tr>
      <th>0.8</th>
      <td>13</td>
      <td>32</td>
    </tr>
    <tr>
      <th>1.0</th>
      <td>1</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">fraud_data.groupby(&quot;class&quot;)[['interval_after_signup']].mean()#action velocity(consecutive operations/actions of user)
#interval_after_signup on frauds are significantly lower compared to legits
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>interval_after_signup</th>
    </tr>
    <tr>
      <th>class</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.191179e+06</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.570226e+06</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">fraud_data.groupby(&quot;class&quot;)[['interval_after_signup']].median()#1
#more than half of fraud happened 1s after signed up
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>interval_after_signup</th>
    </tr>
    <tr>
      <th>class</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5194911.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">fraud_data[fraud_data['class'] == 1].head(100)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>purchase_value</th>
      <th>device_id</th>
      <th>source</th>
      <th>browser</th>
      <th>sex</th>
      <th>age</th>
      <th>ip_address</th>
      <th>class</th>
      <th>country</th>
      <th>interval_after_signup</th>
      <th>signup_days_of_year</th>
      <th>signup_seconds_of_day</th>
      <th>purchase_days_of_year</th>
      <th>purchase_seconds_of_day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>136961</th>
      <td>24</td>
      <td>VLHGCDPFCICDA</td>
      <td>SEO</td>
      <td>Chrome</td>
      <td>F</td>
      <td>33</td>
      <td>3.432126e+09</td>
      <td>1</td>
      <td>United States</td>
      <td>3327952.0</td>
      <td>218</td>
      <td>80113</td>
      <td>257</td>
      <td>38465</td>
    </tr>
    <tr>
      <th>136962</th>
      <td>14</td>
      <td>YLUQSRNYYIPXU</td>
      <td>Ads</td>
      <td>Chrome</td>
      <td>M</td>
      <td>40</td>
      <td>3.905319e+09</td>
      <td>1</td>
      <td>NA</td>
      <td>1.0</td>
      <td>12</td>
      <td>4207</td>
      <td>12</td>
      <td>4208</td>
    </tr>
    <tr>
      <th>136963</th>
      <td>63</td>
      <td>ABUBCQDATQMQH</td>
      <td>Ads</td>
      <td>FireFox</td>
      <td>F</td>
      <td>46</td>
      <td>5.505670e+08</td>
      <td>1</td>
      <td>United States</td>
      <td>7640070.0</td>
      <td>49</td>
      <td>40723</td>
      <td>137</td>
      <td>77593</td>
    </tr>
    <tr>
      <th>136964</th>
      <td>34</td>
      <td>QHEODGCAVJKIQ</td>
      <td>SEO</td>
      <td>Chrome</td>
      <td>M</td>
      <td>37</td>
      <td>9.408096e+08</td>
      <td>1</td>
      <td>United States</td>
      <td>1.0</td>
      <td>12</td>
      <td>77710</td>
      <td>12</td>
      <td>77711</td>
    </tr>
    <tr>
      <th>136965</th>
      <td>76</td>
      <td>DAKVYHKIEYRBH</td>
      <td>SEO</td>
      <td>Chrome</td>
      <td>F</td>
      <td>48</td>
      <td>6.361041e+08</td>
      <td>1</td>
      <td>Hungary</td>
      <td>1.0</td>
      <td>10</td>
      <td>48421</td>
      <td>10</td>
      <td>48422</td>
    </tr>
    <tr>
      <th>136966</th>
      <td>32</td>
      <td>ESANFBTIVMNHX</td>
      <td>Ads</td>
      <td>IE</td>
      <td>M</td>
      <td>30</td>
      <td>3.875475e+09</td>
      <td>1</td>
      <td>NA</td>
      <td>5721252.0</td>
      <td>176</td>
      <td>53824</td>
      <td>242</td>
      <td>72676</td>
    </tr>
    <tr>
      <th>136967</th>
      <td>95</td>
      <td>HIAMXITLJWYCT</td>
      <td>SEO</td>
      <td>FireFox</td>
      <td>M</td>
      <td>42</td>
      <td>3.786924e+09</td>
      <td>1</td>
      <td>NA</td>
      <td>10160108.0</td>
      <td>9</td>
      <td>33511</td>
      <td>126</td>
      <td>84819</td>
    </tr>
    <tr>
      <th>136968</th>
      <td>13</td>
      <td>BQTPLJBGYXQYX</td>
      <td>Ads</td>
      <td>IE</td>
      <td>M</td>
      <td>32</td>
      <td>2.463262e+09</td>
      <td>1</td>
      <td>Austria</td>
      <td>1.0</td>
      <td>12</td>
      <td>29576</td>
      <td>12</td>
      <td>29577</td>
    </tr>
    <tr>
      <th>136969</th>
      <td>15</td>
      <td>BWSMVSLCJXMCM</td>
      <td>Direct</td>
      <td>IE</td>
      <td>F</td>
      <td>39</td>
      <td>2.937899e+09</td>
      <td>1</td>
      <td>Japan</td>
      <td>1.0</td>
      <td>7</td>
      <td>61065</td>
      <td>7</td>
      <td>61066</td>
    </tr>
    <tr>
      <th>136970</th>
      <td>26</td>
      <td>HPPSDIRGUSSTB</td>
      <td>Direct</td>
      <td>Opera</td>
      <td>M</td>
      <td>31</td>
      <td>6.471261e+08</td>
      <td>1</td>
      <td>United States</td>
      <td>1.0</td>
      <td>1</td>
      <td>80617</td>
      <td>1</td>
      <td>80618</td>
    </tr>
    <tr>
      <th>136971</th>
      <td>36</td>
      <td>EGLGSEGYPMMAM</td>
      <td>SEO</td>
      <td>FireFox</td>
      <td>M</td>
      <td>37</td>
      <td>3.503224e+09</td>
      <td>1</td>
      <td>United States</td>
      <td>1.0</td>
      <td>5</td>
      <td>29882</td>
      <td>5</td>
      <td>29883</td>
    </tr>
    <tr>
      <th>136972</th>
      <td>44</td>
      <td>HYRFZNHBIQKEB</td>
      <td>SEO</td>
      <td>Chrome</td>
      <td>F</td>
      <td>27</td>
      <td>3.833762e+09</td>
      <td>1</td>
      <td>NA</td>
      <td>3124880.0</td>
      <td>74</td>
      <td>4707</td>
      <td>110</td>
      <td>19187</td>
    </tr>
    <tr>
      <th>136973</th>
      <td>18</td>
      <td>JCCAZQKFWLFBL</td>
      <td>SEO</td>
      <td>Chrome</td>
      <td>M</td>
      <td>39</td>
      <td>2.614880e+09</td>
      <td>1</td>
      <td>United States</td>
      <td>1.0</td>
      <td>5</td>
      <td>44317</td>
      <td>5</td>
      <td>44318</td>
    </tr>
    <tr>
      <th>136974</th>
      <td>20</td>
      <td>LJUKQHFBFOFPF</td>
      <td>SEO</td>
      <td>Chrome</td>
      <td>F</td>
      <td>22</td>
      <td>2.608608e+09</td>
      <td>1</td>
      <td>United States</td>
      <td>1.0</td>
      <td>12</td>
      <td>62576</td>
      <td>12</td>
      <td>62577</td>
    </tr>
    <tr>
      <th>136975</th>
      <td>66</td>
      <td>IOKXXNDSOKGZN</td>
      <td>Direct</td>
      <td>Chrome</td>
      <td>M</td>
      <td>33</td>
      <td>3.043803e+08</td>
      <td>1</td>
      <td>United States</td>
      <td>4772256.0</td>
      <td>33</td>
      <td>36131</td>
      <td>88</td>
      <td>56387</td>
    </tr>
    <tr>
      <th>136976</th>
      <td>46</td>
      <td>UPNCTKQEABWVP</td>
      <td>SEO</td>
      <td>IE</td>
      <td>F</td>
      <td>25</td>
      <td>1.327620e+09</td>
      <td>1</td>
      <td>Italy</td>
      <td>3597846.0</td>
      <td>13</td>
      <td>76309</td>
      <td>55</td>
      <td>45355</td>
    </tr>
    <tr>
      <th>136977</th>
      <td>60</td>
      <td>AMSMXOCUAXHEB</td>
      <td>Ads</td>
      <td>FireFox</td>
      <td>F</td>
      <td>29</td>
      <td>1.904296e+09</td>
      <td>1</td>
      <td>China</td>
      <td>5840703.0</td>
      <td>200</td>
      <td>38897</td>
      <td>268</td>
      <td>4400</td>
    </tr>
    <tr>
      <th>136978</th>
      <td>17</td>
      <td>XWXRLYQMYMDEA</td>
      <td>Ads</td>
      <td>Opera</td>
      <td>F</td>
      <td>36</td>
      <td>2.605922e+09</td>
      <td>1</td>
      <td>United States</td>
      <td>5653171.0</td>
      <td>162</td>
      <td>4157</td>
      <td>227</td>
      <td>41328</td>
    </tr>
    <tr>
      <th>136979</th>
      <td>19</td>
      <td>DBQZUPAQSCLRM</td>
      <td>SEO</td>
      <td>IE</td>
      <td>M</td>
      <td>39</td>
      <td>7.198889e+08</td>
      <td>1</td>
      <td>China</td>
      <td>9499007.0</td>
      <td>35</td>
      <td>22657</td>
      <td>145</td>
      <td>17664</td>
    </tr>
    <tr>
      <th>136980</th>
      <td>27</td>
      <td>IIGQRPMAOWKNV</td>
      <td>Ads</td>
      <td>IE</td>
      <td>F</td>
      <td>47</td>
      <td>1.430332e+09</td>
      <td>1</td>
      <td>Israel</td>
      <td>5985456.0</td>
      <td>161</td>
      <td>77537</td>
      <td>231</td>
      <td>14993</td>
    </tr>
    <tr>
      <th>136981</th>
      <td>16</td>
      <td>DUWBOKQPPDQUK</td>
      <td>Direct</td>
      <td>FireFox</td>
      <td>M</td>
      <td>23</td>
      <td>1.679643e+09</td>
      <td>1</td>
      <td>United States</td>
      <td>3011256.0</td>
      <td>164</td>
      <td>33799</td>
      <td>199</td>
      <td>21055</td>
    </tr>
    <tr>
      <th>136982</th>
      <td>65</td>
      <td>CXICHNYDPUZNN</td>
      <td>Ads</td>
      <td>Chrome</td>
      <td>M</td>
      <td>39</td>
      <td>1.948216e+09</td>
      <td>1</td>
      <td>China</td>
      <td>1.0</td>
      <td>5</td>
      <td>40348</td>
      <td>5</td>
      <td>40349</td>
    </tr>
    <tr>
      <th>136983</th>
      <td>51</td>
      <td>OPYQBBMQTBFLX</td>
      <td>SEO</td>
      <td>FireFox</td>
      <td>F</td>
      <td>28</td>
      <td>1.016756e+09</td>
      <td>1</td>
      <td>Japan</td>
      <td>1.0</td>
      <td>8</td>
      <td>70048</td>
      <td>8</td>
      <td>70049</td>
    </tr>
    <tr>
      <th>136984</th>
      <td>30</td>
      <td>QACMCZJECEVVA</td>
      <td>SEO</td>
      <td>Chrome</td>
      <td>M</td>
      <td>45</td>
      <td>3.952522e+09</td>
      <td>1</td>
      <td>NA</td>
      <td>6938800.0</td>
      <td>77</td>
      <td>40290</td>
      <td>157</td>
      <td>67090</td>
    </tr>
    <tr>
      <th>136985</th>
      <td>53</td>
      <td>PFZXGECQNBYVI</td>
      <td>Ads</td>
      <td>FireFox</td>
      <td>F</td>
      <td>47</td>
      <td>1.179107e+09</td>
      <td>1</td>
      <td>Canada</td>
      <td>855520.0</td>
      <td>38</td>
      <td>5591</td>
      <td>47</td>
      <td>83511</td>
    </tr>
    <tr>
      <th>136986</th>
      <td>45</td>
      <td>FRITFBEXOSJEI</td>
      <td>Ads</td>
      <td>IE</td>
      <td>F</td>
      <td>22</td>
      <td>1.367518e+09</td>
      <td>1</td>
      <td>United Kingdom</td>
      <td>1.0</td>
      <td>6</td>
      <td>78498</td>
      <td>6</td>
      <td>78499</td>
    </tr>
    <tr>
      <th>136987</th>
      <td>42</td>
      <td>PBQTNXFSTRFQP</td>
      <td>Direct</td>
      <td>Opera</td>
      <td>M</td>
      <td>19</td>
      <td>2.228515e+09</td>
      <td>1</td>
      <td>Canada</td>
      <td>1.0</td>
      <td>5</td>
      <td>59206</td>
      <td>5</td>
      <td>59207</td>
    </tr>
    <tr>
      <th>136988</th>
      <td>28</td>
      <td>JLQCKPZRNFWJI</td>
      <td>SEO</td>
      <td>Chrome</td>
      <td>M</td>
      <td>42</td>
      <td>2.080777e+09</td>
      <td>1</td>
      <td>Indonesia</td>
      <td>1.0</td>
      <td>1</td>
      <td>78881</td>
      <td>1</td>
      <td>78882</td>
    </tr>
    <tr>
      <th>136989</th>
      <td>72</td>
      <td>DVSLIYUBWZOSG</td>
      <td>Direct</td>
      <td>Chrome</td>
      <td>F</td>
      <td>18</td>
      <td>2.362259e+09</td>
      <td>1</td>
      <td>China</td>
      <td>4662544.0</td>
      <td>164</td>
      <td>62103</td>
      <td>218</td>
      <td>59047</td>
    </tr>
    <tr>
      <th>136990</th>
      <td>17</td>
      <td>KIOAANGVZEFLA</td>
      <td>Ads</td>
      <td>Chrome</td>
      <td>F</td>
      <td>26</td>
      <td>2.773100e+08</td>
      <td>1</td>
      <td>United States</td>
      <td>1.0</td>
      <td>4</td>
      <td>8118</td>
      <td>4</td>
      <td>8119</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>137031</th>
      <td>30</td>
      <td>AIWIXWKDTFQVX</td>
      <td>Ads</td>
      <td>Chrome</td>
      <td>M</td>
      <td>48</td>
      <td>1.725179e+08</td>
      <td>1</td>
      <td>NA</td>
      <td>5046794.0</td>
      <td>195</td>
      <td>61591</td>
      <td>254</td>
      <td>10785</td>
    </tr>
    <tr>
      <th>137032</th>
      <td>23</td>
      <td>RPLWHSIFJLCKX</td>
      <td>Direct</td>
      <td>Chrome</td>
      <td>M</td>
      <td>22</td>
      <td>9.928317e+07</td>
      <td>1</td>
      <td>Iran (ISLAMIC Republic Of)</td>
      <td>4510660.0</td>
      <td>92</td>
      <td>64014</td>
      <td>144</td>
      <td>81874</td>
    </tr>
    <tr>
      <th>137033</th>
      <td>20</td>
      <td>LJUKQHFBFOFPF</td>
      <td>SEO</td>
      <td>Chrome</td>
      <td>F</td>
      <td>22</td>
      <td>2.608608e+09</td>
      <td>1</td>
      <td>United States</td>
      <td>1.0</td>
      <td>12</td>
      <td>62578</td>
      <td>12</td>
      <td>62579</td>
    </tr>
    <tr>
      <th>137034</th>
      <td>40</td>
      <td>QKYBDKNISUYVP</td>
      <td>SEO</td>
      <td>Chrome</td>
      <td>M</td>
      <td>35</td>
      <td>1.547484e+09</td>
      <td>1</td>
      <td>Ukraine</td>
      <td>1.0</td>
      <td>9</td>
      <td>1964</td>
      <td>9</td>
      <td>1965</td>
    </tr>
    <tr>
      <th>137035</th>
      <td>39</td>
      <td>HXTMZVLUKOFAD</td>
      <td>SEO</td>
      <td>IE</td>
      <td>M</td>
      <td>33</td>
      <td>4.589109e+08</td>
      <td>1</td>
      <td>Japan</td>
      <td>1.0</td>
      <td>11</td>
      <td>33979</td>
      <td>11</td>
      <td>33980</td>
    </tr>
    <tr>
      <th>137036</th>
      <td>9</td>
      <td>MPMBZBEATLCTJ</td>
      <td>Ads</td>
      <td>Chrome</td>
      <td>M</td>
      <td>35</td>
      <td>3.468521e+09</td>
      <td>1</td>
      <td>United States</td>
      <td>10266556.0</td>
      <td>162</td>
      <td>36908</td>
      <td>281</td>
      <td>21864</td>
    </tr>
    <tr>
      <th>137037</th>
      <td>55</td>
      <td>AXOTAPGOHGRNH</td>
      <td>SEO</td>
      <td>IE</td>
      <td>M</td>
      <td>32</td>
      <td>4.072713e+09</td>
      <td>1</td>
      <td>NA</td>
      <td>749361.0</td>
      <td>98</td>
      <td>4766</td>
      <td>106</td>
      <td>62927</td>
    </tr>
    <tr>
      <th>137038</th>
      <td>18</td>
      <td>XFIBIOCOQTQRK</td>
      <td>SEO</td>
      <td>IE</td>
      <td>M</td>
      <td>25</td>
      <td>2.521950e+09</td>
      <td>1</td>
      <td>Japan</td>
      <td>1.0</td>
      <td>3</td>
      <td>83734</td>
      <td>3</td>
      <td>83735</td>
    </tr>
    <tr>
      <th>137039</th>
      <td>63</td>
      <td>QGSXIVXDKZLJV</td>
      <td>Ads</td>
      <td>Safari</td>
      <td>M</td>
      <td>28</td>
      <td>2.660181e+09</td>
      <td>1</td>
      <td>United Kingdom</td>
      <td>6553579.0</td>
      <td>64</td>
      <td>64075</td>
      <td>140</td>
      <td>51254</td>
    </tr>
    <tr>
      <th>137040</th>
      <td>91</td>
      <td>XPSSLODFBMYCV</td>
      <td>SEO</td>
      <td>IE</td>
      <td>F</td>
      <td>36</td>
      <td>3.956890e+09</td>
      <td>1</td>
      <td>NA</td>
      <td>1.0</td>
      <td>4</td>
      <td>30606</td>
      <td>4</td>
      <td>30607</td>
    </tr>
    <tr>
      <th>137041</th>
      <td>24</td>
      <td>VGQHYSVZKFFLT</td>
      <td>SEO</td>
      <td>Chrome</td>
      <td>M</td>
      <td>26</td>
      <td>1.596802e+09</td>
      <td>1</td>
      <td>Ireland</td>
      <td>1.0</td>
      <td>12</td>
      <td>61875</td>
      <td>12</td>
      <td>61876</td>
    </tr>
    <tr>
      <th>137042</th>
      <td>34</td>
      <td>NLQHWNMQFDMPP</td>
      <td>SEO</td>
      <td>Opera</td>
      <td>M</td>
      <td>31</td>
      <td>3.231719e+09</td>
      <td>1</td>
      <td>United States</td>
      <td>3763980.0</td>
      <td>159</td>
      <td>18483</td>
      <td>202</td>
      <td>67263</td>
    </tr>
    <tr>
      <th>137043</th>
      <td>63</td>
      <td>TRNITRGCBTVJT</td>
      <td>Ads</td>
      <td>IE</td>
      <td>M</td>
      <td>54</td>
      <td>3.694361e+09</td>
      <td>1</td>
      <td>Japan</td>
      <td>1.0</td>
      <td>2</td>
      <td>50272</td>
      <td>2</td>
      <td>50273</td>
    </tr>
    <tr>
      <th>137044</th>
      <td>61</td>
      <td>NDHGQNDQQXCCQ</td>
      <td>SEO</td>
      <td>Opera</td>
      <td>F</td>
      <td>23</td>
      <td>6.807264e+08</td>
      <td>1</td>
      <td>United States</td>
      <td>1.0</td>
      <td>9</td>
      <td>85102</td>
      <td>9</td>
      <td>85103</td>
    </tr>
    <tr>
      <th>137045</th>
      <td>62</td>
      <td>VIQTECHERERRU</td>
      <td>SEO</td>
      <td>IE</td>
      <td>M</td>
      <td>29</td>
      <td>1.551734e+09</td>
      <td>1</td>
      <td>Russian Federation</td>
      <td>6862456.0</td>
      <td>226</td>
      <td>5827</td>
      <td>305</td>
      <td>42683</td>
    </tr>
    <tr>
      <th>137046</th>
      <td>52</td>
      <td>ZAFLHFPXNLZAT</td>
      <td>SEO</td>
      <td>Chrome</td>
      <td>M</td>
      <td>24</td>
      <td>2.879986e+09</td>
      <td>1</td>
      <td>United States</td>
      <td>1.0</td>
      <td>2</td>
      <td>2207</td>
      <td>2</td>
      <td>2208</td>
    </tr>
    <tr>
      <th>137047</th>
      <td>75</td>
      <td>ZQHJZQQFQKGII</td>
      <td>Ads</td>
      <td>Chrome</td>
      <td>M</td>
      <td>18</td>
      <td>2.378426e+08</td>
      <td>1</td>
      <td>Korea Republic of</td>
      <td>1.0</td>
      <td>10</td>
      <td>6164</td>
      <td>10</td>
      <td>6165</td>
    </tr>
    <tr>
      <th>137048</th>
      <td>69</td>
      <td>UWEPEOUQYEPZF</td>
      <td>Direct</td>
      <td>Chrome</td>
      <td>M</td>
      <td>36</td>
      <td>2.534293e+09</td>
      <td>1</td>
      <td>Italy</td>
      <td>1.0</td>
      <td>8</td>
      <td>41847</td>
      <td>8</td>
      <td>41848</td>
    </tr>
    <tr>
      <th>137049</th>
      <td>31</td>
      <td>GVROQHGFQEPJP</td>
      <td>SEO</td>
      <td>Chrome</td>
      <td>M</td>
      <td>40</td>
      <td>2.613576e+09</td>
      <td>1</td>
      <td>United States</td>
      <td>1.0</td>
      <td>4</td>
      <td>77464</td>
      <td>4</td>
      <td>77465</td>
    </tr>
    <tr>
      <th>137050</th>
      <td>52</td>
      <td>JFRURZMOKVSXG</td>
      <td>SEO</td>
      <td>Chrome</td>
      <td>M</td>
      <td>31</td>
      <td>3.280105e+09</td>
      <td>1</td>
      <td>Greece</td>
      <td>4423533.0</td>
      <td>185</td>
      <td>13836</td>
      <td>236</td>
      <td>30969</td>
    </tr>
    <tr>
      <th>137051</th>
      <td>24</td>
      <td>SHRFXSTLQFBDB</td>
      <td>Ads</td>
      <td>Chrome</td>
      <td>M</td>
      <td>46</td>
      <td>3.808984e+09</td>
      <td>1</td>
      <td>NA</td>
      <td>1470753.0</td>
      <td>97</td>
      <td>39902</td>
      <td>114</td>
      <td>41855</td>
    </tr>
    <tr>
      <th>137052</th>
      <td>39</td>
      <td>UFUWUODDBTPCY</td>
      <td>Direct</td>
      <td>Opera</td>
      <td>M</td>
      <td>32</td>
      <td>3.376669e+08</td>
      <td>1</td>
      <td>United States</td>
      <td>1.0</td>
      <td>10</td>
      <td>24909</td>
      <td>10</td>
      <td>24910</td>
    </tr>
    <tr>
      <th>137053</th>
      <td>22</td>
      <td>AVLHWBLLHTDNN</td>
      <td>Direct</td>
      <td>Chrome</td>
      <td>F</td>
      <td>41</td>
      <td>8.578302e+08</td>
      <td>1</td>
      <td>United Kingdom</td>
      <td>2077805.0</td>
      <td>42</td>
      <td>52720</td>
      <td>66</td>
      <td>56925</td>
    </tr>
    <tr>
      <th>137054</th>
      <td>26</td>
      <td>FBHIRVGVKKWAI</td>
      <td>Ads</td>
      <td>IE</td>
      <td>F</td>
      <td>36</td>
      <td>2.278096e+06</td>
      <td>1</td>
      <td>NA</td>
      <td>1.0</td>
      <td>7</td>
      <td>75219</td>
      <td>7</td>
      <td>75220</td>
    </tr>
    <tr>
      <th>137055</th>
      <td>17</td>
      <td>KEQVDINWCZMWA</td>
      <td>Ads</td>
      <td>FireFox</td>
      <td>M</td>
      <td>25</td>
      <td>3.343852e+09</td>
      <td>1</td>
      <td>United States</td>
      <td>1.0</td>
      <td>9</td>
      <td>13729</td>
      <td>9</td>
      <td>13730</td>
    </tr>
    <tr>
      <th>137056</th>
      <td>21</td>
      <td>AIGPGDVRDKOKT</td>
      <td>SEO</td>
      <td>FireFox</td>
      <td>F</td>
      <td>45</td>
      <td>3.058136e+09</td>
      <td>1</td>
      <td>India</td>
      <td>1.0</td>
      <td>2</td>
      <td>69762</td>
      <td>2</td>
      <td>69763</td>
    </tr>
    <tr>
      <th>137057</th>
      <td>52</td>
      <td>PQGKGQACIARBV</td>
      <td>Ads</td>
      <td>Chrome</td>
      <td>F</td>
      <td>36</td>
      <td>7.203338e+08</td>
      <td>1</td>
      <td>China</td>
      <td>1.0</td>
      <td>9</td>
      <td>77018</td>
      <td>9</td>
      <td>77019</td>
    </tr>
    <tr>
      <th>137058</th>
      <td>54</td>
      <td>XHZBVWFWHSGTQ</td>
      <td>SEO</td>
      <td>FireFox</td>
      <td>M</td>
      <td>50</td>
      <td>2.249217e+09</td>
      <td>1</td>
      <td>United States</td>
      <td>1.0</td>
      <td>1</td>
      <td>32483</td>
      <td>1</td>
      <td>32484</td>
    </tr>
    <tr>
      <th>137059</th>
      <td>10</td>
      <td>WETYPHOQVLWMK</td>
      <td>Ads</td>
      <td>FireFox</td>
      <td>M</td>
      <td>36</td>
      <td>2.293333e+09</td>
      <td>1</td>
      <td>United States</td>
      <td>1.0</td>
      <td>7</td>
      <td>63914</td>
      <td>7</td>
      <td>63915</td>
    </tr>
    <tr>
      <th>137060</th>
      <td>69</td>
      <td>UWEPEOUQYEPZF</td>
      <td>Direct</td>
      <td>Chrome</td>
      <td>M</td>
      <td>36</td>
      <td>2.534293e+09</td>
      <td>1</td>
      <td>Italy</td>
      <td>1.0</td>
      <td>8</td>
      <td>41850</td>
      <td>8</td>
      <td>41851</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 14 columns</p>
</div>

<h3 id="final-result">Final Result</h3>

<ul>
<li>recommended:
green: 1 - 3 pass<br />
grey: 4-7 need manual investigation<br />
red: 8,9 decline<br />
1:     1<br />
2: 24555<br />
3:  2623<br />
4:    99<br />
5:   177<br />
6:    76<br />
7:     1<br />
8:    20<br />
9:   124<br /></li>
</ul>

                
                
<div class="entry-shang text-center">
    
	    <p>「真诚赞赏，手留余香」</p>
	
	<button class="zs show-zs btn btn-bred">赞赏支持</button>
</div>
<div class="zs-modal-bg"></div>
<div class="zs-modal-box">
	<div class="zs-modal-head">
		<button type="button" class="close">×</button>
		<span class="author"><a href="https://shichushi.com"><img src="/img/favicon.png" />Chace&#39;s Blog</a></span>
        
	        <p class="tip"><i></i><span>真诚赞赏，手留余香</span></p>
		
 
	</div>
	<div class="zs-modal-body">
		<div class="zs-modal-btns">
			<button class="btn btn-blink" data-num="2">2元</button>
			<button class="btn btn-blink" data-num="5">5元</button>
			<button class="btn btn-blink" data-num="10">10元</button>
			<button class="btn btn-blink" data-num="50">50元</button>
			<button class="btn btn-blink" data-num="100">100元</button>
			<button class="btn btn-blink" data-num="1">任意金额</button>
		</div>
		<div class="zs-modal-pay">
			<button class="btn btn-bred" id="pay-text">2元</button>
			<p>使用<span id="pay-type">微信</span>扫描二维码完成支付</p>
			<img src="/img/reward/wechat-2.png"  id="pay-image"/>
		</div>
	</div>
	<div class="zs-modal-footer">
		<label><input type="radio" name="zs-type" value="wechat" class="zs-type" checked="checked"><span ><span class="zs-wechat"><img src="/img/reward/wechat-btn.png"/></span></label>
		<label><input type="radio" name="zs-type" value="alipay" class="zs-type" class="zs-alipay"><img src="/img/reward/alipay-btn.png"/></span></label>
	</div>
</div>
<script type="text/javascript" src="/js/reward.js"></script>

                

                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2018/10/07/churn-prediction/" data-toggle="tooltip" data-placement="top" title="Customer Churn Prediction in Telecommunications Industry">&larr;
                            Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2019/02/01/demand-prediction/" data-toggle="tooltip" data-placement="top" title="Supply Chain Demand Forecasting and Data Management">Next
                            Post &rarr;</a>
                    </li>
                    
                </ul>

                
<div id="disqus-comment"></div>



            </div>
            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                        
                        
                        
                        
                        
                        <a href="/tags/bigdata-analysis" title="Bigdata Analysis">
                            Bigdata Analysis
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/data-analysis" title="Data Analysis">
                            Data Analysis
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/machine-learning" title="Machine Learning">
                            Machine Learning
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/r-shiny" title="R-shiny">
                            R-shiny
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/spark" title="Spark">
                            Spark
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                    </div>
                </section>
                

                
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                   
                   <li>
                       <a href='' rel="alternate" type="application/rss+xml" title="Chace&#39;s Blog" >
                           <span class="fa-stack fa-lg">
                               <i class="fa fa-circle fa-stack-2x"></i>
                               <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                           </span>
                       </a>
                   </li>
                   
                    
                    <li>
                        <a href="mailto:cshi46@wisc.edu">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    

                    

		    
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/Chauncey315">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/in/chushishi">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    
                    
            
                </ul>
		<p class="copyright text-muted">
                    Copyright &copy; Chace&#39;s Blog 2020. All rights reserved.
                    <br>
                    采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议，转载请注明出处
                    <br>
                    Powered by <a href="https://themes.gohugo.io/hugo-theme-cleanwhite">CleanWhite Hugo Theme</a>
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    async("https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>







<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        displayMath: [['$$','$$'], ['\[','\]']],
        processEscapes: true,
        processEnvironments: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        TeX: { equationNumbers: { autoNumber: "AMS" },
             extensions: ["AMSmath.js", "AMSsymbols.js"] }
      }
    });
    </script>
    

</body>
</html>
